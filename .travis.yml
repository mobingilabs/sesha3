os:
  - linux

language: go

go:
  - 1.9.2

script:
  - go build -v

before_deploy:
  - tar cvzf app.tar.gz sesha3 appspec.yml scripts/ tools/
  - mkdir -p dpl_cd_upload
  - cp app.tar.gz dpl_cd_upload/

deploy:
  - provider: s3
    access_key_id: AKIAINLJDAMNCZZ5NRDA
    secret_access_key: &1
      secure: rHgRElkx4z1Ne4KvrHvsx8nWK/jiF/xfvYfwtXm3pWgxQLpt6ansHcjM93JDr1AxywmtgkMmjzxN4w1T85dHASZFt06llbdwNUDcAn1ZsmAg0U+vDrF/OrISAdLyeunM7WLMFAqlwyU+Iu0jVdtFv7dDbn85ZGQs5R03XDO5dD3rrOmdr6PfRQZlPXeCttPf0VsNwqO75lIb0shxzdCcJUUwIkA2IICpBWWHbqBqcmH5eqDF4kGGPFR4/4uuw5SW9VyXTUOEaQeKxOv6wJcBDTEc8CD9gyYnbaku6JCUJE3L8PgatjJzslefjdPvDjVDVMdgByJy+1ijAnzCeZ6E7eGltDbTPIl9c+cir/dNG0y0z0Bsl6oJV8al40dyDOfU0J23zT+/gmK+SP5sXMl8Wnhq6EO9z9wvcwnNnDdNf2Vpcl834PWJTCtYmhrWBxPoBykKiZQEJTGDVqrdEZpNtui7Yy08Wk+q/o7ueVht3wQuXQDNPYHrUttQDDAyNYo/4hY47atUasnWKs/PRA9C1cuq5wOeu1Ns/dA7sZVLqJzeBnf1Y/QkSHC7psMEqxLgCiIpGnis4Ywt9fH8U4xhQ8H1NJ262T8PbjXjJQkHOGezbKHLXE2rogGYVXGL7IRXY7O3k8CHGaZoWGJAV+MyMxzRciIT1aHvXH2s35ud/Fk=
    local_dir: dpl_cd_upload
    skip_cleanup: true
    on: &2
      repo: mobingilabs/sesha3
      branch: develop
    bucket: sesha3
    upload_dir: latest
    region: ap-northeast-1
  - provider: codedeploy
    access_key_id: AKIAINLJDAMNCZZ5NRDA
    secret_access_key: *1
    bucket: sesha3
    key: latest/app.tar.gz
    bundle_type: tgz
    application: sesha3
    deployment_group: sesha3dg
    region: ap-northeast-1
    on: *2

notifications:
  slack:
    secure: mTqgOEARoIec1iErPkuRwC6zL6H0P3zkGTTeCZv6ZdPqE5GIupqEp7ACEbPloFyvxGKKiM8eS0JWf1GlmMymozAb9tF3gd5NetS4evbXmuk+HjNNKdwfhsB2c/y5n22+Eg5TTJTpF1AQxLnHqgLpL7pVHD7YUzZy2bJr99G5WWPcZ1MO+LCq1oQBK1jk2o5SFjoPVsUWlNqCfUiE7C2dTcC5PKnI65KmVDRPhk6gcuJvr70Uwbcx1PCB2lS/jLfrdwAtvYs/2+kFQJgd0hmmPVo+EL0WImhvsNcNPArOQeYByncw5lAwG2HLQ5uT1eILrR1i6W0cCKIAxmN/2aMPMUh5p8ypv+GQ/GA18jav6SxOK/pAbHPdONx2gsOkoVRSA2wFVVNuyKH9foO9uZTos3ErdpOtX0TDsetUUhnsiBzp0dnoh3QjbAwaeVJRrv76HGaXGcoLc+QqJrfASaunelMoA7GFf8A0tVa72eVDOSIiINtoxAhWDtES+W0koOMde5EbZL88y9Ji4ptZJJUj3FEgTn1b+LVkcPtlLwhMeq3UPPQrOoycrb6mRCISbRN3ViWUjKBR2Y+j7ROjGg/d4/ARSBky/jGftHXr0OOyRyw/QuAVP5M/UJJgeIKUp8wg4PeOc+CNwM82Jp0ZJzfzQmJdtwq+5VnN1vOHx9ZkWMc=
